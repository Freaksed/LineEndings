/** AddFacebookCreditsView  *	---------------------------------------------------------------------------- *  *	@author:  *		Christian Widodo [christian@avatarlabs.com]  *	---------------------------------------------------------------------------- */ 	package com.boogabooga.ui.maingame	{		import flash.display.MovieClip;		import flash.display.StageDisplayState;		import flash.events.Event;		import flash.events.EventDispatcher;		import flash.external.ExternalInterface;		import flash.text.TextField;		import flash.text.TextFieldAutoSize;				import com.avatarlabs.utils.console.ConsoleBroadcaster;		import com.avatarlabs.utils.events.CustomEvent;		import com.avatarlabs.utils.events.EventNotificationCenter;		import com.avatarlabs.utils.sound.SoundEffectPlayer;		import com.avatarlabs.utils.userinterface.DynamicUIButton;		import com.avatarlabs.utils.text.TextFormatting;				import com.boogabooga.controller.FacebookFunctions;		import com.boogabooga.controller.maingame.MainGameController;		import com.boogabooga.data.SoundsIndex;		import com.boogabooga.data.StringsIndex;		import com.boogabooga.events.BoogaEvent;		import com.boogabooga.ui.maingame.AbstractContentView;		import com.boogabooga.ui.maingame.IContentView;				public class AddFacebookCreditsView extends AbstractContentView implements IContentView		{			protected var _exitClip:DynamicUIButton;			protected var _buyClip:DynamicUIButton;			protected var _earnClip:DynamicUIButton;						protected var _headerMinY:Number;			protected var _headerMaxHeight:Number;						/**	Stage Instances **/			public var header_txt:TextField;			public var exit_mc:MovieClip;			public var background_mc:MovieClip;			public var buy_mc:MovieClip;			public var earn_mc:MovieClip;			public var blackBackground_mc:MovieClip;			/**	End of Stage Instances **/						/** Constructor			  *	---------------------------------------------------------------------------- */				public function AddFacebookCreditsView()				{					//init();				}								override public function set contentClip( m:MovieClip ):void				{					super.contentClip = m;										blackBackground_mc = _contentClip.blackBackground_mc;					blackBackground_mc.cacheAsBitmap = true;					header_txt = _contentClip.header_txt;					exit_mc = _contentClip.exit_mc;					background_mc = _contentClip.background_mc;					buy_mc = _contentClip.buy_mc;					buy_mc.mouseChildren = false;					earn_mc = _contentClip.earn_mc;					earn_mc.mouseChildren = false;										_exitClip = new DynamicUIButton();					_exitClip.dynamicClip = exit_mc;					_exitClip.dynamicInit();										_buyClip = new DynamicUIButton();					_buyClip.dynamicClip = buy_mc;					_buyClip.dynamicInit();										_earnClip = new DynamicUIButton();					_earnClip.dynamicClip = earn_mc;					_earnClip.dynamicInit();										_headerMinY = header_txt.y;					_headerMaxHeight = header_txt.height;									}							/** init			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				override public function init():void				{					super.init();										EventNotificationCenter.getInstance().addSignalListener( BoogaEvent.ON_LANGUAGE_CHANGED, handleLanguageChanged, this );										TextFormatting.formatTextWithFontName( header_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_ADD_HEADER"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( buy_mc.label_mc.label_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_BUY"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					TextFormatting.formatTextWithFontName( buy_mc.label_mc.label_txt, "Buy", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( earn_mc.label_mc.label_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_EARN"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					TextFormatting.formatTextWithFontName( earn_mc.label_mc.label_txt, "Earn", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					header_txt.y = _headerMinY + int((_headerMaxHeight-header_txt.height)/2);										_exitClip.addEventListener( "onClick", handleExitClicked, false, 0, true );					_exitClip.addEventListener( "onSetFocus", handleExitRolledOver, false, 0, true );										_buyClip.addEventListener( "onClick", handleBuyClicked, false, 0, true );					_buyClip.addEventListener( "onSetFocus", handleBuyRolledOver, false, 0, true );					_buyClip.addEventListener( "onKillFocus", handleBuyRolledOut, false, 0, true );										_earnClip.addEventListener( "onClick", handleEarnClicked, false, 0, true );					_earnClip.addEventListener( "onSetFocus", handleEarnRolledOver, false, 0, true );					_earnClip.addEventListener( "onKillFocus", handleEarnRolledOut, false, 0, true );										try					{						ExternalInterface.addCallback( "handleOffersComplete", handleOffersComplete );					}					catch( e:Error ) {}				}							/** kill			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				public function kill():void				{									}							/** show			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				override public function show():void				{					super.show();				}							/** hide			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				override public function hide():void				{					super.hide();										dispatchEvent( new BoogaEvent(BoogaEvent.ON_POPUP_HIDE) );				}							/** handleExitClicked			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleExitClicked( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										hide();				}								protected function handleExitRolledOver( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );				}							/** handleBuyClicked			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleBuyClicked( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										if( _contentClip.stage.displayState == StageDisplayState.FULL_SCREEN )						_contentClip.stage.displayState = StageDisplayState.NORMAL;										MainGameController.getInstance().facebookFunctions.addMoreFacebookCredits();				}								protected function handleBuyRolledOver( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_SHOW, this, {clip:_buyClip.dynamicClip, text:StringsIndex.getInstance().getStringByName("FB_CREDITS_BUY"), align:TextFieldAutoSize.LEFT} );				}								protected function handleBuyRolledOut( event:Event ):void				{					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_HIDE, this );				}							/** handleEarnClicked			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleEarnClicked( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										if( _contentClip.stage.displayState == StageDisplayState.FULL_SCREEN )						_contentClip.stage.displayState = StageDisplayState.NORMAL;										ExternalInterface.call( 'openOffers' );				}								protected function handleEarnRolledOver( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_SHOW, this, {clip:_earnClip.dynamicClip, text:StringsIndex.getInstance().getStringByName("FB_CREDITS_EARN"), align:TextFieldAutoSize.LEFT} );				}								protected function handleEarnRolledOut( event:Event ):void				{					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_HIDE, this );				}							/** handleOffersComplete			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleOffersComplete():void				{					hide();				}							/** handleLanguageChanged			  *	---------------------------------------------------------------------------- *			  *	Updates the texts when the language is changed.			  *	---------------------------------------------------------------------------- */				private function handleLanguageChanged( customParameters:Object ):void				{					//trace( "AddFacebookCreditsView -- handleLanguageChanged();" );										TextFormatting.formatTextWithFontName( header_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_ADD_HEADER"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					header_txt.y = _headerMinY + int((_headerMaxHeight-header_txt.height)/2);					//TextFormatting.formatTextWithFontName( buy_mc.label_mc.label_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_BUY"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( earn_mc.label_mc.label_txt, StringsIndex.getInstance().getStringByName("FB_CREDITS_EARN"), "Lithos Pro Black", false, TextFieldAutoSize.CENTER );				}		}	}