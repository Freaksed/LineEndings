/** StoreItemIcon  *	---------------------------------------------------------------------------- *  *	@author:  *		Christian Widodo [christian@avatarlabs.com]  *	---------------------------------------------------------------------------- */ 	package com.boogabooga.ui.maingame.store	{		import flash.display.Bitmap;		import flash.display.MovieClip;		import flash.events.Event;		import flash.events.EventDispatcher;		import flash.text.TextField;		import flash.text.TextFieldAutoSize;				import com.avatarlabs.utils.cache.BitmapDataManager;		import com.avatarlabs.utils.events.CustomEvent;		import com.avatarlabs.utils.events.EventNotificationCenter;		import com.avatarlabs.utils.userinterface.DynamicUIButton;		import com.avatarlabs.utils.text.TextFormatting;				import com.boogabooga.controller.maingame.MainGameController;		import com.boogabooga.data.StringsIndex;		import com.boogabooga.data.maingame.Village;		import com.boogabooga.data.gamelevel.AbstractGameObject;		import com.boogabooga.events.BoogaEvent;				public class StoreItemIcon extends DynamicUIButton		{			protected var _item:AbstractGameObject;						/**	Stage Instances **/			public var lock_mc:MovieClip;			public var image_mc:MovieClip;			/**	End of Stage Instances **/						/** Constructor			  *	---------------------------------------------------------------------------- */				public function StoreItemIcon()				{					super();				}								public function set item( a:AbstractGameObject ):void				{									}				public function get item():AbstractGameObject { return _item; }								override public function set dynamicClip( m:MovieClip ):void				{					super.dynamicClip = m;										lock_mc = _dynamicClip.lock_mc;					image_mc = _dynamicClip.image_mc;				}								override public function dynamicInit():void				{					super.dynamicInit();										lock_mc.visible = true;										EventNotificationCenter.getInstance().addSignalListener( BoogaEvent.ON_LANGUAGE_CHANGED, handleLanguageChanged, this );				}								public function reset():void				{					while( image_mc.numChildren > 0 )						image_mc.removeChildAt(0);				}							/** showLockView			  *	---------------------------------------------------------------------------- *			  *	Shows a lock view and displays the text of when levels will be unlocked.			  *	---------------------------------------------------------------------------- */				public function showLockView( item:AbstractGameObject ):void				{					while( image_mc.numChildren > 0 )						image_mc.removeChildAt(0);										image_mc.visible = false;										TextFormatting.formatTextWithFontName( lock_mc.label_txt, StringsIndex.getInstance().getStringByName("STORE_UNLOCKS_IN")+" "+(item.availableOnLevel-MainGameController.getInstance().currentUser.level)+" levels", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					lock_mc.visible = true;										setDeactive(false);				}							/** showItemView			  *	---------------------------------------------------------------------------- *			  *	Shows the item view with the image.			  *	---------------------------------------------------------------------------- */				public function showItemView( item:AbstractGameObject ):void				{					_item = item;										while( image_mc.numChildren > 0 )						image_mc.removeChildAt(0);										lock_mc.visible = false;					var iconBitmap:Bitmap = new Bitmap(BitmapDataManager.getInstance().getBitmapData(_item.cacheIconId).bitmapData);						iconBitmap.width = 50;						iconBitmap.height = 50;										image_mc.addChild( iconBitmap );										setActive(true);				}							/** handleLanguageChanged			  *	---------------------------------------------------------------------------- *			  *	When a language is changed, update the text accordingly.			  *	---------------------------------------------------------------------------- */				protected function handleLanguageChanged( customParameters:Object ):void				{					TextFormatting.formatTextWithFontName( lock_mc.label_txt, StringsIndex.getInstance().getStringByName("STORE_UNLOCKS_IN")+" "+(item.availableOnLevel-MainGameController.getInstance().currentUser.level)+" levels", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );				}						}	}