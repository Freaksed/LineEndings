/** FacebookCreditsBalanceView  *	---------------------------------------------------------------------------- *  *	@author:  *		Christian Widodo [christian@avatarlabs.com]  *	---------------------------------------------------------------------------- */ 	package com.boogabooga.ui.maingame	{		import flash.display.MovieClip;		import flash.events.Event;		import flash.events.EventDispatcher;		import flash.text.TextField;		import flash.text.TextFieldAutoSize;				import com.avatarlabs.utils.console.ConsoleBroadcaster;		import com.avatarlabs.utils.events.CustomEvent;		import com.avatarlabs.utils.events.EventNotificationCenter;		import com.avatarlabs.utils.sound.SoundEffectPlayer;		import com.avatarlabs.utils.userinterface.DynamicUIButton;		import com.avatarlabs.utils.text.TextFormatting;				import com.boogabooga.controller.FacebookFunctions;		import com.boogabooga.controller.maingame.MainGameController;		import com.boogabooga.controller.maingame.UserDataController;		import com.boogabooga.data.SoundsIndex;		import com.boogabooga.data.StringsIndex;		import com.boogabooga.events.BoogaEvent;				public class FacebookCreditsBalanceView extends EventDispatcher		{			protected var _contentClip:MovieClip;						protected var _addClip:DynamicUIButton;			protected var _normalScreenY:Number;						/**	Stage Instances **/			public var label_txt:TextField;			public var background_mc:MovieClip;			public var add_mc:MovieClip;			/**	End of Stage Instances **/						/** Constructor			  *	---------------------------------------------------------------------------- */				public function FacebookCreditsBalanceView()				{					//init();				}								public function set contentClip( m:MovieClip ):void				{					_contentClip = m;										_normalScreenY = _contentClip.y;										label_txt = _contentClip.label_txt;					label_txt.text = '';										add_mc = _contentClip.add_mc;										_addClip = new DynamicUIButton();					_addClip.dynamicClip = add_mc;					_addClip.dynamicInit();				}				public function get contentClip():MovieClip { return _contentClip; }								public function get normalScreenY():Number { return _normalScreenY; }							/** init			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				public function init():void				{					if( MainGameController.getInstance().facebookFunctions.isInitialized )					{						MainGameController.getInstance().facebookFunctions.addEventListener( BoogaEvent.ON_FACEBOOK_GET_BALANCE_COMPLETE, handleGetBalanceComplete );						MainGameController.getInstance().facebookFunctions.getFacebookCreditsBalance();					}										_addClip.addEventListener( "onClick", handleAddClicked, false, 0, true );					_addClip.addEventListener( "onSetFocus", handleAddRolledOver, false, 0, true );					_addClip.addEventListener( "onKillFocus", handleAddRolledOut, false, 0, true );				}							/** kill			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				public function kill():void				{									}							/** handlePlayClicked			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleGetBalanceComplete( event:BoogaEvent ):void				{					ConsoleBroadcaster.broadcast( "FacebookCreditsBalanceView", "handleGetBalanceComplete();" );										MainGameController.getInstance().currentUser.fbCreditsBalance = event.customParameters.balance;										TextFormatting.formatTextWithFontName( label_txt, event.customParameters.balance, "Lithos Pro Black", false, TextFieldAutoSize.LEFT );										var userDataController:UserDataController = new UserDataController();						userDataController.updateUserFBCreditBalance( MainGameController.getInstance().currentUser.id, event.customParameters.balance );				}							/** handleAddClicked			  *	---------------------------------------------------------------------------- *			  *	---------------------------------------------------------------------------- */				protected function handleAddClicked( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );										dispatchEvent( new BoogaEvent(BoogaEvent.ON_FACEBOOK_ADD_CREDITS) );				}								protected function handleAddRolledOver( event:Event ):void				{					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_SHOW, this, {clip:_addClip.dynamicClip, text:StringsIndex.getInstance().getStringByName("FB_CREDITS_ADD_HEADER")} );				}								protected function handleAddRolledOut( event:Event ):void				{					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_HIDE, this );				}						}	}