/** ResultScreenLose  *	---------------------------------------------------------------------------- *  *	@author:  *		Christian Widodo [christian@avatarlabs.com]  *	---------------------------------------------------------------------------- */ 	package com.boogabooga.ui.gamelevel	{		import flash.display.Bitmap;		import flash.display.MovieClip;		import flash.events.Event;		import flash.events.EventDispatcher;		import flash.text.TextField;		import flash.text.TextFieldAutoSize;				import com.avatarlabs.utils.cache.BitmapDataManager;		import com.avatarlabs.utils.console.ConsoleBroadcaster;		import com.avatarlabs.utils.events.CustomEvent;		import com.avatarlabs.utils.events.EventNotificationCenter;		import com.avatarlabs.utils.sound.SoundEffectPlayer;		import com.avatarlabs.utils.text.TextFormatting;		import com.avatarlabs.utils.userinterface.DynamicUIButton;				import com.boogabooga.data.SoundsIndex;		import com.boogabooga.data.StringsIndex;		import com.boogabooga.data.gamelevel.AbstractGameObject;		import com.boogabooga.data.gamelevel.GameLevelDataIndex;		import com.boogabooga.data.maingame.Village;		import com.boogabooga.events.BoogaEvent;				public class ResultScreenLose extends EventDispatcher		{			protected var _contentClip:MovieClip;						protected var _playAgainClip:DynamicUIButton;			protected var _islandSelectClip:DynamicUIButton;						protected var _enemyClips:Array;			protected var _enemyId:int;						protected var _isWoodPlaying:Boolean;			protected var _isSmokePlaying:Boolean;						/**	Stage Instances **/			public var background_mc:MovieClip;			public var woodflying_mc:MovieClip;			public var smoke_mc:MovieClip;			public var playAgain_mc:MovieClip;			public var islandSelect_mc:MovieClip;			//public var label_mc:MovieClip;			public var puncher01_mc:MovieClip;			public var puncher02_mc:MovieClip;			public var puncher03_mc:MovieClip;			public var puncher04_mc:MovieClip;			public var puncher05_mc:MovieClip;			public var puncher06_mc:MovieClip;			public var projectile01_mc:MovieClip;			public var projectile02_mc:MovieClip;			public var laser01_mc:MovieClip;			public var jumper01_mc:MovieClip;			public var jumper02_mc:MovieClip;			public var superJumper_mc:MovieClip;			//public var flyer01_mc:MovieClip;			//public var flyer02_mc:MovieClip;			public var egg01_mc:MovieClip;			public var egg02_mc:MovieClip;			public var catapult01_mc:MovieClip;			public var catapult02_mc:MovieClip;			public var ghost01_mc:MovieClip;			public var ghost02_mc:MovieClip;			/**	End of Stage Instances **/						/** Constructor			  *	---------------------------------------------------------------------------- */				public function ResultScreenLose()				{					//init();				}								public function set contentClip( m:MovieClip ):void				{					_contentClip = m;					_contentClip.addEventListener( "onPlaySmoke", handlePlaySmoke );					_contentClip.addEventListener( "onPlayWood", handlePlayWood );					_contentClip.addEventListener( "onPlayAnimationComplete", handlePlayAnimationComplete, false, 0, true );										playAgain_mc = _contentClip.playAgain_mc;					playAgain_mc.cacheAsBitmap = true;					islandSelect_mc = _contentClip.islandSelect_mc;					islandSelect_mc.cacheAsBitmap = true;					//label_mc = _contentClip.label_mc;					//label_mc.gotoAndStop(1);										woodflying_mc = _contentClip.woodflying_mc;					woodflying_mc.stop();					woodflying_mc.visible = false;					smoke_mc = _contentClip.smoke_mc;					smoke_mc.stop();					smoke_mc.visible = false;										background_mc = _contentClip.background_mc;					background_mc.cacheAsBitmap = true;										puncher01_mc = _contentClip.puncher01_mc;					puncher01_mc.visible = false;					puncher02_mc = _contentClip.puncher02_mc;					puncher02_mc.visible = false;					puncher03_mc = _contentClip.puncher03_mc;					puncher03_mc.visible = false;					puncher04_mc = _contentClip.puncher04_mc;					puncher04_mc.visible = false;					puncher05_mc = _contentClip.puncher05_mc;					puncher05_mc.visible = false;					puncher06_mc = _contentClip.puncher06_mc;					puncher06_mc.visible = false;					projectile01_mc = _contentClip.projectile01_mc;					projectile01_mc.visible = false;					projectile02_mc = _contentClip.projectile02_mc;					projectile02_mc.visible = false;					laser01_mc = _contentClip.laser01_mc;					laser01_mc.visible = false;					jumper01_mc = _contentClip.jumper01_mc;					jumper01_mc.visible = false;					jumper02_mc = _contentClip.jumper02_mc;					jumper02_mc.visible = false;					superJumper_mc = _contentClip.superJumper_mc;					superJumper_mc.visible = false;					//flyer01_mc = _contentClip.flyer01_mc;					//flyer01_mc.visible = false;					//flyer02_mc = _contentClip.flyer02_mc;					//flyer02_mc.visible = false;					egg01_mc = _contentClip.egg01_mc;					egg01_mc.visible = false;					egg02_mc = _contentClip.egg02_mc;					egg02_mc.visible = false;					catapult01_mc = _contentClip.catapult01_mc;					catapult01_mc.visible = false;					catapult02_mc = _contentClip.catapult02_mc;					catapult02_mc.visible = false;					ghost01_mc = _contentClip.ghost01_mc;					ghost01_mc.visible = false;					ghost02_mc = _contentClip.ghost02_mc;					ghost02_mc.visible = false;										_enemyClips = [ puncher01_mc, puncher02_mc, puncher03_mc, puncher04_mc, puncher05_mc, puncher06_mc, projectile01_mc, projectile02_mc, laser01_mc, jumper01_mc, jumper02_mc, superJumper_mc, egg01_mc, egg02_mc, catapult01_mc, catapult02_mc, ghost01_mc, ghost02_mc ];				}				public function get contentClip():MovieClip { return _contentClip; }								public function set enemyId( i:int ):void				{					_enemyId = i;										for( var i:int=0; i<_enemyClips.length; ++i )					{						_enemyClips[i].cacheAsBitmap = false;						_enemyClips[i].visible = false;					}										switch( _enemyId )					{						case 26:							catapult01_mc.visible = true;							catapult01_mc.cacheAsBitmap = true;							break;												case 27:							catapult02_mc.visible = true;							catapult02_mc.cacheAsBitmap = true;							break;												case 20:						case 8:							egg01_mc.visible = true;							egg01_mc.cacheAsBitmap = true;							break;													case 21:						case 23:							egg02_mc.visible = true;							egg02_mc.cacheAsBitmap = true;							break;												case 5:							//flyer01_mc.visible = true;							//flyer01_mc.cacheAsBitmap = true;							break;													case 17:							//flyer02_mc.visible = true;							//flyer02_mc.cacheAsBitmap = true;							break;													case 9:							jumper01_mc.visible = true;							jumper01_mc.cacheAsBitmap = true;							break;													case 18:							jumper02_mc.visible = true;							jumper02_mc.cacheAsBitmap = true;							break;													case 4:							laser01_mc.visible = true;							laser01_mc.cacheAsBitmap = true;							break;													case 24:							projectile01_mc.visible = true;							projectile01_mc.cacheAsBitmap = true;							break;													case 25:							projectile02_mc.visible = true;							projectile02_mc.cacheAsBitmap = true;							break;													case 13:							puncher01_mc.visible = true;							puncher01_mc.cacheAsBitmap = true;							break;													case 14:							puncher02_mc.visible = true;							puncher02_mc.cacheAsBitmap = true;							break;													case 15:							puncher03_mc.visible = true;							puncher03_mc.cacheAsBitmap = true;							break;													case 3:							puncher04_mc.visible = true;							puncher04_mc.cacheAsBitmap = true;							break;													case 16:							puncher05_mc.visible = true;							puncher05_mc.cacheAsBitmap = true;							break;													case 12:							puncher06_mc.visible = true;							puncher06_mc.cacheAsBitmap = true;							break;													case 19:							superJumper_mc.visible = true;							superJumper_mc.cacheAsBitmap = true;							break;												case 29:							ghost01_mc.visible = true;							//ghost01_mc.cacheAsBitmap = true;							break;												case 30:							ghost02_mc.visible = true;							//ghost02_mc.cacheAsBitmap = true;							break;					}				}							/** init			  *	---------------------------------------------------------------------------- */				public function init():void				{					//label_mc.gotoAndStop(1);										_playAgainClip = new DynamicUIButton();					_playAgainClip.dynamicClip = playAgain_mc;					_playAgainClip.dynamicInit();					_playAgainClip.addEventListener( "onClick", handlePlayAgainClicked, false, 0, true );					_playAgainClip.addEventListener( "onSetFocus", handlePlayAgainRolledOver, false, 0, true );					_playAgainClip.addEventListener( "onKillFocus", handlePlayAgainRolledOut, false, 0, true );										_islandSelectClip = new DynamicUIButton();					_islandSelectClip.dynamicClip = islandSelect_mc;					_islandSelectClip.dynamicInit();					_islandSelectClip.addEventListener( "onClick", handleIslandSelectClicked, false, 0, true );					_islandSelectClip.addEventListener( "onSetFocus", handleIslandSelectRolledOver, false, 0, true );					_islandSelectClip.addEventListener( "onKillFocus", handleIslandSelectRolledOut, false, 0, true );															//TextFormatting.formatTextWithFontName( label_mc.animation_mc.label_txt, "Villagers Attacked!", "SF Fedora", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( label_mc.animation2_mc.label_txt, "Villagers Attacked!", "SF Fedora", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( label_mc.animation_mc.label_txt, "Villagers Attacked!", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );					//TextFormatting.formatTextWithFontName( label_mc.animation2_mc.label_txt, "Villagers Attacked!", "Lithos Pro Black", false, TextFieldAutoSize.CENTER );				}							/** show			  *	---------------------------------------------------------------------------- */				public function show():void				{					//label_mc.gotoAndPlay(1);										_contentClip.gotoAndPlay(1);										_contentClip.visible = true;										//SoundEffectPlayer.getInstance().setVolume( SoundsIndex.getInstance().getSoundBySoundId("music_level_lose.wav").volume, 0, "music_level_lose.wav" );					SoundEffectPlayer.getInstance().playLibrarySound( "music_level_lose.wav", false, "music_level_lose.wav", "music_level_lose.wav", SoundEffectPlayer.SOUND_PLAYER_SFX );									}							/** hide			  *	---------------------------------------------------------------------------- */				public function hide():void				{					_contentClip.visible = false;										//label_mc.gotoAndStop(1);										smoke_mc.gotoAndStop(1);					smoke_mc.visible = false;										woodflying_mc.gotoAndStop(1);					woodflying_mc.visible = false;				}								public function pause():void				{					_contentClip.stop();										woodflying_mc.stop();					smoke_mc.stop();				}								public function unpause():void				{					_contentClip.play();										if( woodflying_mc.currentFrame != 1 )					{						woodflying_mc.play();					}										if( smoke_mc.currentFrame != 1 )					{						smoke_mc.play();					}				}							/** handlePlaySmoke			  *	---------------------------------------------------------------------------- */				protected function handlePlaySmoke( event:Event ):void				{					smoke_mc.visible = true;					smoke_mc.gotoAndPlay(2);				}							/** handlePlayWood			  *	---------------------------------------------------------------------------- */				protected function handlePlayWood( event:Event ):void				{					woodflying_mc.visible = true;					woodflying_mc.gotoAndPlay(2);				}							/** handlePlayAnimationComplete			  *	---------------------------------------------------------------------------- */				protected function handlePlayAnimationComplete( event:Event ):void				{					ConsoleBroadcaster.broadcast( "ResultScreenWin", "handlePlayAnimationComplete();" );										dispatchEvent( new BoogaEvent(BoogaEvent.ON_RESULT_SCREEN_LOSE_ANIMATION_DONE) );				}							/** handlePlayAgainClicked			  *	---------------------------------------------------------------------------- */				protected function handlePlayAgainClicked( event:Event ):void				{					//SoundEffectPlayer.getInstance().setVolume( SoundsIndex.getInstance().getSoundBySoundId("sfx_mouse_click.wav").volume, 0, "sfx_mouse_click.wav" );					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav" );										dispatchEvent( new BoogaEvent(BoogaEvent.ON_PLAY_AGAIN) );				}							/** handlePlayAgainRolledOver			  *	---------------------------------------------------------------------------- */				protected function handlePlayAgainRolledOver( event:Event ):void				{					//SoundEffectPlayer.getInstance().setVolume( SoundsIndex.getInstance().getSoundBySoundId("sfx_mouse_rollover.wav").volume, 0, "sfx_mouse_rollover.wav" );					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav" );										EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_SHOW, this, {clip:_playAgainClip.dynamicClip, text:StringsIndex.getInstance().getStringByName("LEVEL_RESULT_PLAY_AGAIN")} );				}							/** handlePlayAgainRolledOut			  *	---------------------------------------------------------------------------- */				protected function handlePlayAgainRolledOut( event:Event ):void				{					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_HIDE, this );				}							/** handleIslandSelectClicked			  *	---------------------------------------------------------------------------- */				protected function handleIslandSelectClicked( event:Event ):void				{					//SoundEffectPlayer.getInstance().setVolume( SoundsIndex.getInstance().getSoundBySoundId("sfx_mouse_click.wav").volume, 0, "sfx_mouse_click.wav" );					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_click.wav", false, "sfx_mouse_click.wav", "sfx_mouse_click.wav" );										dispatchEvent( new BoogaEvent(BoogaEvent.ON_ISLAND_SELECT) );				}							/** handleIslandSelectRolledOver			  *	---------------------------------------------------------------------------- */				protected function handleIslandSelectRolledOver( event:Event ):void				{					//SoundEffectPlayer.getInstance().setVolume( SoundsIndex.getInstance().getSoundBySoundId("sfx_mouse_rollover.wav").volume, 0, "sfx_mouse_rollover.wav" );					SoundEffectPlayer.getInstance().playLibrarySound( "sfx_mouse_rollover.wav", false, "sfx_mouse_rollover.wav", "sfx_mouse_rollover.wav" );										EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_SHOW, this, {clip:_islandSelectClip.dynamicClip, text:StringsIndex.getInstance().getStringByName("LEVEL_RESULT_ISLAND_SELECT")} );				}							/** handleIslandSelectRolledOut			  *	---------------------------------------------------------------------------- */				protected function handleIslandSelectRolledOut( event:Event ):void				{					EventNotificationCenter.getInstance().sendSignal( BoogaEvent.ON_TEXT_HOVER_HIDE, this );				}						}	}